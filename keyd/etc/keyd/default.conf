# /etc/keyd/default.conf
#
#    ██╗  ██╗███████╗██╗   ██╗██████╗ ██╗   ██╗██╗███╗   ███╗
#    ██║ ██╔╝██╔════╝╚██╗ ██╔╝██╔══██╗██║   ██║██║████╗ ████║
#    █████╔╝ █████╗   ╚████╔╝ ██║  ██║██║   ██║██║██╔████╔██║
#    ██╔═██╗ ██╔══╝    ╚██╔╝  ██║  ██║╚██╗ ██╔╝██║██║╚██╔╝██║
#    ██║  ██╗███████╗   ██║   ██████╔╝ ╚████╔╝ ██║██║ ╚═╝ ██║
#    ╚═╝  ╚═╝╚══════╝   ╚═╝   ╚═════╝   ╚═══╝  ╚═╝╚═╝     ╚═╝
#
################################################################################
# KEYDVIM - BASIC VIM-STYLE KEYBINDINGS AND SHORTCUTS
################################################################################
#
# - When 'capslock' is tapped (pressed + released), it behaves as the ESC key
# - When 'capslock' is held it behaves like a 'ctrl' key modifier
# - When 'tab' is held, enter a "vim-lite" layer (keybinds only)
#     This is useful for people who don't run Hyprland but still want a minimal,
#     universal vim-like experience at the OS level.
#
################################################################################
#
# Limitations:
#   This config only remaps keys (no shell script execution and no status
#   indicator), so this is an intentionally light setup but it is still robust.
#   Useful for quick one-off `hjkl` movement or non-advanced text manipulation and
#   navigation. Although HyprVim is currently the more comprehensive solution for
#   vim emulation, this could be edited to used shell scripts; but do so with
#   care as scripts run by keyd are run as root. Also every key must be unmapped
#   individually to prevent fallthrough.
#
################################################################################
#
# How to Exit "vim-lite":
#   Like vim, you may get trapped in vim-lite. To escape:
#   `<backspace>+<escape>+<enter>` will terminate keyd.
#
################################################################################

# ---------------------------------------------------------------------------- #
# !-- IDS
# ---------------------------------------------------------------------------- #

[ids]
*

# ---------------------------------------------------------------------------- #
# !-- MAIN
# ---------------------------------------------------------------------------- #

[main]
capslock = overload(ctrl_vim, esc)
control = overload(ctrl_vim, esc)
tab = overload(normal_mode, tab)

# ---------------------------------------------------------------------------- #
# !-- CTRL VIM LAYER
# ---------------------------------------------------------------------------- #

# ctrl_vim modifier layer; inherits from 'Ctrl' modifier layer
# Press backspace while holding tab to enable/disable persistent vim-lite mode
[ctrl_vim:C]
backspace = toggle(normal_mode)

# ---------------------------------------------------------------------------- #
# !-- NORMAL MODE
# ---------------------------------------------------------------------------- #

[normal_mode]
## Movement
h = left
j = down
k = up
l = right
0 = home
n = f3

## Mode switching
esc = toggle(normal_mode)
i = toggle(normal_mode)
c = oneshot(c_normal_mode)
d = oneshot(d_normal_mode)
y = oneshot(y_normal_mode)
a = macro(right esc)
o = macro(end enter esc)
g = oneshot(g_mode)
v = toggle(visual_mode)

## Text
b = C-left
w = macro(C-right C-right C-left)
e = macro(right C-right left)

## Actions
u = C-z
x = delete
p = C-v
/ = C-f

# !-- NORMAL MODE + SHIFT ----------------------------------------------------

[normal_mode+shift]
### Movement
h = home
j = C-down
k = C-up
l = end
6 = home
4 = end
g = C-end
n = S-f3
[ = C-up
] = C-down

## Mode switching
o = macro(end up enter esc)
i = toggle(normal_mode)
a = macro(end esc)
v = toggle(vline_mode)

### Text
b = C-left
w = macro(C-right C-right C-left)
e = macro(right C-right left)

### Actions
x = backspace
/ = C-f
c = macro(C-S-right S-delete)
d = macro(C-S-right S-delete)
y = macro(C-S-right C-insert)
p = macro(home enter up S-insert)

#### Search highlighted word
8 = macro(C-right C-S-left 20ms C-insert 10ms C-f 20ms S-insert)
3 = macro(C-right C-S-left 20ms C-insert 10ms C-f 20ms S-insert)

# !-- NORMAL MODE + CONTROL --------------------------------------------------

[normal_mode+control]
## Movement
d = pagedown
u = pageup
f = scrolldown
b = scrollup

### Actions
r = C-y

# !-- NORMAL MODE (Change) --------------------------------------------------

[c_normal_mode]
c = macro(home C-S-end S-delete)
i = oneshot(ci_normal_mode)
a = oneshot(ci_normal_mode)

# !-- NORMAL MODE (Change/Inner/A) --------------------------------------------------
[ci_normal_mode]
w = macro(C-right C-S-left S-delete)
p = macro(C-up C-S-down S-delete)

# !-- NORMAL MODE (Delete) --------------------------------------------------

[d_normal_mode]
d = macro(home C-S-end S-delete)
i = oneshot(di_normal_mode)
a = oneshot(di_normal_mode)

# !-- NORMAL MODE (Delete/Inner/A) --------------------------------------------------
[di_normal_mode]
w = macro(C-right C-S-left S-delete)
p = macro(C-up C-S-down S-delete)

# !-- NORMAL MODE (Yank) --------------------------------------------------

[y_normal_mode]
y = macro(home C-S-end C-c)
i = oneshot(yi_normal_mode)
a = oneshot(yi_normal_mode)

# !-- NORMAL MODE (Yank/Inner/A) --------------------------------------------------
[yi_normal_mode]
w = macro(C-right C-S-left C-c)
p = macro(C-up C-S-down C-c)

# ---------------------------------------------------------------------------- #
# !-- G MODE
# ---------------------------------------------------------------------------- #

[g_mode]
g = C-home
e = macro(C-left C-right)

# ---------------------------------------------------------------------------- #
# !-- VISUAL MODE
# ---------------------------------------------------------------------------- #

[visual_mode]
## Movement
h = S-left
j = S-down
k = S-up
l = S-right
0 = S-home
6 = S-home
- = S-home
4 = S-end

## Text
w = C-S-right
e = C-S-right
b = C-S-left

## Operators
d = macro(S-delete esc)
y = macro(C-c esc)
c = macro(S-delete esc)
x = macro(S-delete esc)

## Mode Switches
i = oneshot(i_visual_mode)
a = oneshot(i_visual_mode)
g = oneshot(g_visual_mode)
v = toggle(visual_mode)
esc = toggle(normal_mode)

# !-- VISUAL MODE + SHIFT ----------------------------------------------------

[visual_mode+shift]
h = S-left
j = S-down
k = S-up
l = S-right
g = C-S-end
4 = S-end
6 = S-home

# !-- VISUAL MODE (INNER/A) --------------------------------------------------

[i_visual_mode]
w = macro(C-right C-S-left)
p = macro(C-up C-S-down)

# !-- G VISUAL MODE ----------------------------------------------------------

[g_visual_mode]
g = C-S-home

# ---------------------------------------------------------------------------- #
# !-- VISUAL LINE MODE
# ---------------------------------------------------------------------------- #

[vline_mode]
j = S-down
k = S-up

## Operators
d = macro(S-delete esc)
y = macro(C-c esc)
c = macro(S-delete esc)
x = macro(S-delete esc)

## Mode Switches
g = oneshot(g_vline_mode)
v = toggle(vline_mode)
esc = toggle(normal_mode)

# !-- VISUAL LINE MODE + SHIFT -----------------------------------------------

[vline_mode+shift]
v = toggle(vline_mode)
g = macro(home C-S-end)

# ---------------------------------------------------------------------------- #
# !-- G VISUAL LINE MODE
# ---------------------------------------------------------------------------- #

[g_vline_mode]
g = macro(end C-S-home)

# !-- G VISUAL LINE MODE + SHIFT ---------------------------------------------

[g_vline_mode+shift]
g = macro(home C-S-end)


