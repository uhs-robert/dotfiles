-- hypr/.config/hypr/theme/lib/generators/waybar.lua
-- Waybar CSS theme generator

local Utils = require("lib.utils")
local BaseGenerator = require("lib.generators.base")

local WaybarGenerator = setmetatable({}, { __index = BaseGenerator })
WaybarGenerator.__index = WaybarGenerator

function WaybarGenerator:new()
	local obj = BaseGenerator:new()
	setmetatable(obj, self)
	return obj
end

function WaybarGenerator:generate(palette, output_dir, palette_name)
	local content = string.format(
		[[/* waybar/.config/waybar/theme-colors.css */
/* Generated by theme/main.lua */
/* DO NOT EDIT MANUALLY - regenerate with: lua ~/.config/hypr/theme/main.lua */

/* Backgrounds */
@define-color bg_core %s;
@define-color bg_mantle %s;
@define-color bg_shadow %s;
@define-color bg_surface %s;

/* Foregrounds */
@define-color fg_core %s;
@define-color fg_strong %s;
@define-color fg_muted %s;
@define-color fg_dim %s;

/* Accents */
@define-color primary %s;
@define-color secondary %s;
@define-color accent %s;
@define-color yellow %s;

/* Status Colors */
@define-color error %s;
@define-color warning %s;
@define-color info %s;
@define-color hint %s;
@define-color ok %s;

/* ANSI Colors (for reference) */
@define-color red %s;
@define-color green %s;
@define-color blue %s;
@define-color cyan %s;
@define-color magenta %s;
]],
		Utils.ensure_hex(palette.bg_core),
		Utils.ensure_hex(palette.bg_mantle),
		Utils.ensure_hex(palette.bg_shadow),
		Utils.ensure_hex(palette.bg_surface),
		Utils.ensure_hex(palette.fg_core),
		Utils.ensure_hex(palette.fg_strong),
		Utils.ensure_hex(palette.fg_muted),
		Utils.ensure_hex(palette.fg_dim),
		Utils.ensure_hex(palette.theme_primary),
		Utils.ensure_hex(palette.theme_secondary),
		Utils.ensure_hex(palette.theme_accent),
		Utils.ensure_hex(palette.yellow),
		Utils.ensure_hex(palette.error),
		Utils.ensure_hex(palette.warning),
		Utils.ensure_hex(palette.info),
		Utils.ensure_hex(palette.hint),
		Utils.ensure_hex(palette.ok),
		Utils.ensure_hex(palette.red),
		Utils.ensure_hex(palette.green),
		Utils.ensure_hex(palette.blue),
		Utils.ensure_hex(palette.cyan),
		Utils.ensure_hex(palette.magenta)
	)

	local output_path = output_dir .. "/waybar-theme.css"
	return self:write_output(output_path, content)
end

return WaybarGenerator
